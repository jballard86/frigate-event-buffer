# Frigate Event Buffer Configuration
# ===================================
#
# Copy this file to config.yaml and update with your values:
#   cp config.example.yaml config.yaml
#
# This file contains non-sensitive application settings.
# Sensitive values can also be set via environment variables,
# which always override values in this file.

# Camera configuration with per-camera label filtering
# Only events from listed cameras will be processed
# Omit a camera entirely to filter it out
cameras:
  # Example: Doorbell - only person and package events
  - name: "YOUR_CAMERA_1"
    labels:
      - "person"
      - "package"

  # Example: Driveway - only vehicle events, with Smart Zone Filtering
  # Only create event when object enters a tracked zone (e.g. driveway); exceptions trigger anywhere
  - name: "YOUR_CAMERA_2"
    labels:
      - "car"
      - "truck"
    event_filters:              # Optional - omit for legacy behavior (all events start immediately)
      tracked_zones:            # Only create event when object enters one of these Frigate zones
        - driveway
      exceptions:               # Labels or sub_labels that create event regardless of zone
        - person
        - UPS
        - FedEx

  # Example: Backyard - allow ALL labels (empty list), no zone filtering
  # - name: "YOUR_CAMERA_3"
  #   labels: []

# Application settings
settings:
  # How many days to keep event recordings
  retention_days: 3

  # How often to run cleanup (in hours)
  cleanup_interval_hours: 1

  # FFmpeg transcode timeout in seconds (kills hung processes)
  ffmpeg_timeout_seconds: 60

  # Delay before fetching snapshot after initial notification (seconds)
  # Notification is sent instantly; this delay lets Frigate select a better frame
  # before the snapshot update. Set to 0 to fetch immediately.
  notification_delay_seconds: 1

  # Logging level: DEBUG, INFO, WARNING, ERROR
  log_level: "INFO"

  # Review summary time padding (seconds)
  # Controls the time window sent to Frigate's review summary API
  # Covers activity from all GenAI-equipped cameras in the time range
  summary_padding_before: 15   # seconds before event start
  summary_padding_after: 15    # seconds after event end

  # Stats panel auto-refresh interval (seconds)
  # How often the Stats view refreshes when displayed
  stats_refresh_seconds: 60

  # Daily Review (Frigate review summarize API)
  # How long to keep saved daily reviews (days)
  daily_review_retention_days: 90
  # Hour (0-23) to run daily review fetch for previous day
  daily_review_schedule_hour: 1

  # Consolidated event series
  # Time since last event before the next one starts a NEW consolidated group.
  # If no events for 120s, the next event is new. If an event occurs within
  # this gap, it continues the group and the gap resets.
  event_gap_seconds: 120
  # Export time range buffers (seconds)
  export_buffer_before: 5
  export_buffer_after: 30

# Network configuration
# These can be overridden by environment variables:
#   MQTT_BROKER, MQTT_PORT, FRIGATE_URL, BUFFER_IP, FLASK_PORT, STORAGE_PATH
network:
  mqtt_broker: "YOUR_MQTT_BROKER_IP"
  mqtt_port: 1883
  # mqtt_user: "your_mqtt_user"
  # mqtt_password: "your_mqtt_password"
  frigate_url: "http://YOUR_FRIGATE_IP:5000"
  # IP/hostname where this buffer container is reachable (used in notification image/video URLs)
  buffer_ip: "YOUR_BUFFER_IP"
  flask_port: 5055
  storage_path: "/app/storage"

# Optional: Gemini proxy (AI analysis) - for clip GenAI summaries
# Single API Key: set GEMINI_API_KEY in environment for production (no separate proxy key).
# No Google Fallback: default proxy URL is ""; set in config or GEMINI_PROXY_URL env.
# gemini:
#   proxy_url: "http://YOUR_PROXY_IP:5050"
#   api_key: ""
#   model: "gemini-2.5-flash-lite"
#   enabled: true

# Optional: Multi-cam frame extractor (for future multi-cam recap feature)
# multi_cam:
#   max_multi_cam_frames_min: 45
#   max_multi_cam_frames_sec: 2    # target capture interval (seconds)
#   motion_threshold_px: 50       # min pixels movement for high-rate capture
#   crop_width: 1280
#   crop_height: 720
#   multi_cam_system_prompt_file: ""   # path to prompt file; empty = use built-in

# Optional: Gemini proxy (extended) - model params for proxy calls (e.g. multi-cam)
# API key: GEMINI_API_KEY only. Proxy URL: set here or GEMINI_PROXY_URL env (default "").
# gemini_proxy:
#   url: ""                       # no Google fallback; set explicitly
#   model: "gemini-2.5-flash-lite"
#   temperature: 0.3
#   top_p: 1
#   frequency_penalty: 0
#   presence_penalty: 0

# Optional: Home Assistant REST API (for stats page API Usage display)
# Uncomment and set to show Gemini cost/token usage on the stats page
# ha:
#   base_url: "http://YOUR_HA_IP:8123/api"
#   token: "YOUR_LONG_LIVED_ACCESS_TOKEN"
#   gemini_cost_entity: "input_number.gemini_daily_cost"
#   gemini_tokens_entity: "input_number.gemini_total_tokens"
